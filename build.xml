<project name="jpaypal" basedir="." default="validate">

 <property name="jpaypaldir" value="${basedir}/.."/>
 <property file="${jpaypaldir}/build.properties" />
 <property name="BuildPropsDotJava" value="${jpaypaldir}/jpaypal-domain/src/main/java/mars/jpaypal/domain/build/BuildProps.java"/>
 <property name="sdkConfigProperites" value="${jpaypaldir}/jpaypal-server/src/main/resources/sdk_config.properties"/>

 <target name="validate" depends="checkProp, copyConfig"/>

 <target name="checkProp" depends="checkBuildDotPropertiesExists"
                           unless="${buildDotPropertiesExists}">
  <echo>Copying build.properties-template to build.properties</echo>
  <copy file="${jpaypaldir}/build.properties-template"
      tofile="${jpaypaldir}/build.properties" verbose="yes"/>
 </target>

 <target name="copyConfig" depends="checkProp">
  <!-- Copy BuildProps.java -->
  <copy file="${BuildPropsDotJava}-template"
      tofile="${BuildPropsDotJava}" overwrite="yes" />
  <replace file="${BuildPropsDotJava}"
          token="@EDIT-WARNING-NOTE@" value="Do not edit this file directly!, modify BuildProps.java-template instead."/>
  <replace file="${BuildPropsDotJava}"
          token="@SERVICE-BASE-URI@" value="${paypal.serviceBaseUri}"/>
  <replace file="${BuildPropsDotJava}"
          token="@CLIENT-ID@" value="${paypal.clientId}"/>
  <replace file="${BuildPropsDotJava}"
          token="@CLIENT-SECRET@" value="${paypal.clientSecret}"/>
  <!-- Copy sdk_config.properties -->
  <copy file="${sdkConfigProperites}-template"
      tofile="${sdkConfigProperites}" overwrite="yes"/>
  <replace file="${sdkConfigProperites}"
          token="@EDIT-WARNING-NOTE@" value="Do not edit this file directly!, modify sdk_config.properties-template instead."/>
  <replace file="${sdkConfigProperites}"
          token="@CLIENT-ID@" value="${paypal.clientId}"/>
  <replace file="${sdkConfigProperites}"
          token="@CLIENT-SECRET@" value="${paypal.clientSecret}"/>
  <replace file="${sdkConfigProperites}"
          token="@SERVICE-END-POINT@" value="${paypal.serviceEndPoint}"/>
  <replace file="${sdkConfigProperites}"
          token="@HTTP-USE-PROXY@" value="${paypal.http.UseProxy}"/>
 </target>

 <target name="checkBuildDotPropertiesExists">
  <available property="buildDotPropertiesExists"
                 file="${jpaypaldir}/build.properties"/>
 </target>

</project>